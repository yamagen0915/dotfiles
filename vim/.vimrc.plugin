set nocompatible

set runtimepath^=~/.vim/dein/repos/github.com/Shougo/dein.vim

call dein#begin(expand('~/.vim/dein'))

  " deinè‡ªèº«ã‚’deinã§ç®¡ç†ã™ã‚‹
  call dein#add('Shougo/dein.vim')
  " vimä¸Šã§ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹ãƒ—ãƒ©ã‚°ã‚¤ãƒ³
  call dein#add('Shougo/vimproc.vim', {'build' : 'make'})
  " You can specify revision/branch/tag.
  call dein#add('Shougo/vimshell', { 'rev': '3787e5' })
  " Emmet
  call dein#add('mattn/emmet-vim')
  " è£œå®Œ
  call dein#add('Shougo/neocomplete.vim')
  " ã‚¹ãƒ‹ãƒšãƒƒãƒˆ
  call dein#add('Shougo/neosnippet.vim')
  call dein#add('Shougo/neosnippet-snippets')
  call dein#add('honza/vim-snippets')
  " ãƒ•ã‚¡ã‚¤ãƒ©ãƒ¼çš„ãª
  call dein#add('Shougo/unite.vim')
  " Uniteã§é–¢æ•°ä¸€è¦§ãªã©ã®ã‚¢ã‚¦ãƒˆãƒ©ã‚¤ãƒ³ã‚’è¡¨ç¤ºã™ã‚‹
  call dein#add('Shougo/unite-outline')
  " Unite ã‹ã‚‰gitã‚’åˆ©ç”¨ã§ãã‚‹ã‚ˆã†ã«
  call dein#add('kmnk/vim-unite-giti.git')
  " Unite ã§æœ€è¿‘é–‹ã„ãŸãƒ•ã‚¡ã‚¤ãƒ«ã‚’è¦‹ã‚Œã‚‹
  call dein#add('Shougo/neomru.vim')
  " ifã‚„doã‚’å…¥åŠ›ã—ãŸã‚‰è‡ªå‹•çš„ã«endã‚’æŒ¿å…¥ã—ã¦ãã‚Œã‚‹
  call dein#add('tpope/vim-endwise')
  " vimã§Gitã‚’æ‰±ã†
  call dein#add('tpope/vim-fugitive')
  " Gitã®å¤‰æ›´ã‚’è¦‹ã‚„ã™ãã™ã‚‹
  call dein#add('airblade/vim-gitgutter')
  " :RTã¨ã‹ã§å¯¾å¿œã™ã‚‹viewã¨ã‹ã«ç§»å‹•ã§ãã‚‹
  call dein#add('tpope/vim-rails')
  " ãƒ†ã‚­ã‚¹ãƒˆã‚’ç‰¹å®šã®æ–‡å­—ã§å›²ã‚“ã ã‚Šã™ã‚‹
  call dein#add('tpope/vim-surround')
  " trueã¨falseã‚’ãã‚Šã‹ãˆãŸã‚Š
  call dein#add('AndrewRadev/switch.vim')
  " è¦–è¦šçš„ã«replaceã§ãã‚‹ã‚„ã¤
  call dein#add('osyo-manga/vim-over')
  " é¸æŠç¯„å›²ã‚’å¤–å´ã«åºƒã’ã¦æ¤œç´¢ã§ãã‚‹
  call dein#add('terryma/vim-expand-region')
  "è¡Œå˜ä½ã§diffã‚’ã¿ã‚‹ãŸã‚ã®ãƒ—ãƒ©ã‚°ã‚¤ãƒ³
  call dein#add('AndrewRadev/linediff.vim')
  " ã‚·ãƒ³ã‚¿ãƒƒã‚¯ã‚¹ã‚¨ãƒ©ãƒ¼ã‚’è¦‹ã¤ã‘ã¦ãã‚Œã‚‹ã‚„ã¤
  call dein#add('scrooloose/syntastic.git')
  " ç”»é¢ä¸Šã®è¦‹ãˆã¦ã„ã‚‹ç¯„å›²ã®ç§»å‹•ã‚’æ—©ãã™ã‚‹ãŸã‚ã®ãƒ—ãƒ©ã‚°ã‚¤ãƒ³
  call dein#add('Lokaltog/vim-easymotion')
  " = ã®ä½ç½®ã¨ã‹ãã‚ãˆã‚‰ã‚Œã‚‹ã‚„ã¤ï¼
  call dein#add('junegunn/vim-easy-align')
  " fã®æ¤œç´¢æ©Ÿèƒ½ã‚’å¼·åŒ–ã™ã‚‹
  call dein#add('rhysd/clever-f.vim')
  " ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒ©ã‚¤ãƒ³ã‚’ã‹ã£ã“ã‚ˆã
  call dein#add('itchyny/lightline.vim')
  " ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã®ãƒ­ã‚°ã‚’åé›†ã—ã¦ãã‚Œã‚‹ã‚µãƒ¼ãƒ“ã‚¹
  call dein#add('wakatime/vim-wakatime')
  " jsonã®è¡¨ç¤ºãŒãŠã‹ã—ã„ã®ã‚’æ²»ã™
  call dein#add('elzr/vim-json')
  " ç·¨é›†ã—ã¦ã„ã‚‹ãƒ•ã‚¡ã‚¤ãƒ«ã‚’GitHubã§é–‹ã
  call dein#add('tyru/open-browser.vim')
  call dein#add('tyru/open-browser-github.vim')

  " ==================================================
  " ãƒ†ã‚­ã‚¹ãƒˆã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ
  " ==================================================
  " ãƒ†ã‚­ã‚¹ãƒˆã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆç³»ã®ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ãŒä¾å­˜ã—ã¦ã„ã‚‹ãƒ—ãƒ©ã‚°ã‚¤ãƒ³
  call dein#add('kana/vim-textobj-user')
  " [ l ] ã‚«ãƒ¼ã‚½ãƒ«è¡Œ
  call dein#add('kana/vim-textobj-line')
  " [ u ] Url
  call dein#add('mattn/vim-textobj-url')
  " [ , ] å¼•æ•°
  call dein#add("sgur/vim-textobj-parameter")

  " ==================================================
  " ã‚·ãƒ³ã‚¿ãƒƒã‚¯ã‚¹ãƒã‚¤ãƒ©ã‚¤ãƒˆ
  " ==================================================
  " Coffee
  call dein#add('kchmck/vim-coffee-script', {'autoload':{'filetypes':['coffee']}})
  " Scala
  call dein#add('derekwyatt/vim-scala')
  " React
  call dein#add('pangloss/vim-javascript')
  call dein#add('mxw/vim-jsx')
  " haml
  call dein#add('tpope/vim-haml')

  " æœªã‚¤ãƒ³ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã®ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ãŒã‚ã£ãŸã‚‰ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹
  if dein#check_install()
    call dein#install()
  endif

call dein#end()

filetype plugin on
filetype plugin indent on
filetype indent on

" ==================================================
" Unite
" ==================================================

" Prefix
nnoremap [unite] <nop>
nmap <space>u [unite]

let g:unite_enable_start_insert = 1
let g:unite_enable_split_vertically = 0
let g:unite_winwidth = 40
let g:unite_cursor_line_highlight = 7

" ãƒ•ã‚¡ã‚¤ãƒ«ã¯ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§tabã§é–‹ãã‚ˆã†ã«
call unite#custom#default_action('file', 'tabopen')
" ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã¯ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§å†å¸°çš„ã«ãƒ•ã‚¡ã‚¤ãƒ«ã‚’è¡¨ç¤ºã™ã‚‹ã‚ˆã†ã«
call unite#custom#default_action('directory', 'rec/async')
" ãƒ‰ãƒƒãƒˆãƒ•ã‚¡ã‚¤ãƒ«ãŒè¡¨ç¤ºã•ã‚Œã‚‹ã‚ˆã†ã«
call unite#custom#source('file', 'matchers', "matcher_default")

" ç”»åƒãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ¤œç´¢å¯¾è±¡ã‹ã‚‰å¤–ã™
let s:unite_ignores = join([
    \  '\.gif',
    \  '\.jpg',
    \  '\.jpeg',
    \  '\.png',
    \  '\.webp',
    \  '\.woff',
    \  '\.svg',
    \  '\.psd',
    \  '\.ico',
    \  '\.DS_Store',
    \  '\.keep',
    \  'extlib$',
    \  'extlibs$',
    \  'blib$',
  \  ],'\|')
call unite#custom#source('file', 'ignore_pattern', s:unite_ignores)
call unite#custom#source('file_rec/async', 'ignore_pattern', s:unite_ignores)
call unite#custom#source('file_rec/git', 'ignore_pattern', s:unite_ignores)

nnoremap <silent> [unite]f :<C-u>UniteWithBufferDir -buffer-name=files file<CR>
nnoremap <silent> [unite]p :<C-u>UniteWithProjectDir -buffer-name=files file<CR>
nnoremap <silent> [unite]o :<C-u>Unite outline<CR>
nnoremap <silent> [unite]m :<C-u>Unite file_mru buffer<CR>
nnoremap <silent> [unite]b :<C-u>Unite buffer<CR>

nnoremap <silent> [unite]g :<C-u>Unite grep -buffer-name=grep -default-action=tabopen<CR>
if executable('ag')
  let g:unite_source_grep_command = 'ag'
  let g:unite_source_grep_default_opts = '--nogroup --nocolor --column'
endif

augroup UniteSelectAction
  autocmd!
  autocmd FileType unite inoremap <silent> <buffer> <expr> <C-g> unite#do_action('grep')
  autocmd FileType unite nnoremap <silent> <buffer> <expr> <C-g> unite#do_action('grep')
augroup END


" ==================================================
" neocomplete
" ==================================================

" neocomplcacheã‚’è‡ªå‹•èµ·å‹•ã™ã‚‹
let g:neocomplete#enable_at_startup = 1
" å¤§æ–‡å­—ãŒå…¥åŠ›ã•ã‚Œã‚‹ã¾ã§å¤§æ–‡å­—å°æ–‡å­—ã‚’åŒºåˆ¥ã—ãªã„
let g:neocomplete#enable_smart_case = 1
" ã‚·ãƒ³ã‚¿ãƒƒã‚¯ã‚¹ã‚’ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã™ã‚‹éš›ã®æœ€å°æ–‡å­—é•·
let g:neocomplete#sources#syntax#min_keyword_length = 3
" ãƒãƒƒãƒ•ã‚¡åã®ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’æŒ‡å®šã™ã‚‹
let g:neocomplete#lock_buffer_name_pattern = '\*ku\*'
" ãƒãƒƒãƒ—ã‚¢ãƒƒãƒ—ã§è¡¨ç¤ºã•ã‚Œã‚‹å€™è£œã®æ•°
let g:neocomplete#max_list = 20
" ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã—ãªã„ãƒ•ã‚¡ã‚¤ãƒ«å
let g:neocomplete#sources#buffer#disabled_pattern = '\.log\|\.log\.\|\.jax'
" è‡ªå‹•è£œå®Œã‚’è¡Œã‚ãªã„ãƒãƒƒãƒ•ã‚¡å
let g:neocomplete#lock_buffer_name_pattern = '\.log\|\.log\.\|.*quickrun.*\|.jax'

" rubyã®ã‚ªãƒ ãƒ‹è£œå®Œ
if !exists('g:neocomplete#sources#omni#input_patterns')
  let g:neocomplete#sources#omni#input_patterns = {}
endif
let g:neocomplete#sources#omni#input_patterns.ruby = '[^. *\t]\.\h\w*\|\h\w*::'

" è£œå®Œã‚’ã‚­ãƒ£ãƒ³ã‚»ãƒ«ã—å…ƒã«æˆ»ã™
inoremap <expr><C-g> neocomplete#undo_completion()

" è£œå®Œå€™è£œã®å…±é€šéƒ¨åˆ†ã®ã¿ã‚’è£œå®Œã™ã‚‹
inoremap <expr><C-l> neocomplete#complete_common_string()

" Enterã§å€™è£œã‚’é¸æŠã—ã€æ”¹è¡Œã‚‚ã•ã‚Œãªã„ã‚ˆã†ã«ã™ã‚‹
function! s:my_crinsert()
    return pumvisible() ? neocomplete#close_popup() : "\<Cr>"
endfunction
inoremap <silent> <CR> <C-R>=<SID>my_crinsert()<CR>

" <C-h>, <BS>è£œå®Œã‚’ç¦æ­¢
inoremap <expr><C-h> neocomplete#smart_close_popup()."\<C-h>"
inoremap <expr><BS> neocomplete#smart_close_popup()."\<C-h>"

" ==================================================
" neosnippet
" ==================================================
let g:neosnippet#snippets_directory='~/.vim/dein/repos/github.com/honza/vim-snippets/snippets,~/dotfiles/vim/snippets'

inoremap <expr><S-TAB>  pumvisible() ? "\<C-p>" : "\<S-TAB>"

" Plugin key-mappings.
imap <C-k> <Plug>(neosnippet_expand_or_jump)
smap <C-k> <Plug>(neosnippet_expand_or_jump)

" SuperTab like snippets behavior.
imap <expr><TAB> neosnippet#jumpable() ? "\<Plug>(neosnippet_expand_or_jump)" : pumvisible() ? "\<C-n>" : "\<TAB>"
smap <expr><TAB> neosnippet#jumpable() ? "\<Plug>(neosnippet_expand_or_jump)" : "\<TAB>"

" For snippet_complete marker.
if has('conceal')
  set conceallevel=2 concealcursor=i
endif

" ==================================================
" vim-fugitive
" ==================================================

nnoremap [git] <Nop>
vnoremap [git] <Nop>
nmap <Space>g [git]
vmap <Space>g [git]

nnoremap <silent> [git]df :Gdiff<CR>
nnoremap <silent> [git]ad :Gwrite<CR>
nnoremap <silent> [git]cv :Gcommit -v<CR>
nnoremap <silent> [git]cam :Gcommit --amend<CR>
nnoremap <silent> [git]bl :Gblame<CR>
nnoremap <silent> [git]st :Gstatus<CR>

" ==================================================
" open-browser-github
" ==================================================

nnoremap <silent> [git]g :OpenGithubFile<CR>
vnoremap <silent> [git]g :OpenGithubFile<CR>

" ==================================================
" switch.vim
" ==================================================

" Prefix
nnoremap [switch] <Nop>
nmap <Space>t [switch]

inoremap [switch] :Switch<CR>
nnoremap [switch] :Switch<CR>
vnoremap [switch] :Switch<CR>

augroup SwitchConfig
  autocmd!
  autocmd FileType *  let b:switch_custom_definitions = [
    \   ['true', 'false'],
    \ ]

  " Ruby
  autocmd FileType ruby,eruby,haml let b:switch_custom_definitions = [
    \   ['if', 'unless'],
    \   ['.blank?', '.present?'],
    \   ['include', 'extend'],
    \   ['class', 'module'],
    \   ['attr_accessor', 'attr_reader', 'attr_writer'],
    \ ]

  autocmd FileType perl let b:switch_custom_definitions = [
    \   ['if', 'unless'],
    \ ]
augroup END


" ==================================================
" vim-over
" ==================================================

nnoremap [over] <Nop>
nmap <Space>s [over]
vmap <Space>s [over]

nnoremap <silent> [over]s :OverCommandLine<CR>s/
vnoremap <silent> [over]s :OverCommandLine<CR>s/
nnoremap <silent> [over]% :OverCommandLine<CR>%s/

" ==================================================
" vim-rails
" ==================================================

nnoremap [rails] <Nop>
nmap <Space>r [rails]

nnoremap <silent> gp :bp<CR>

" ==================================================
" vim-easymotion
" ==================================================

"Disable default mappings
let g:EasyMotion_do_mapping = 0
" å¤§æ–‡å­—å°æ–‡å­—ã‚’åŒºåˆ¥ã—ãªã„
let g:EasyMotion_smartcase = 1

nmap <Space>e <Plug>(easymotion-s2)

" ==================================================
" vim-easy-align
" ==================================================

xmap <Space>e <Plug>(EasyAlign)

" ==================================================
" vim-lightline
" ==================================================
set laststatus=2
set t_Co=256

let g:lightline = {
  \   'mode_map': {'c': 'NORMAL'},
  \   'active': {
  \     'right': [
  \        [ 'syntastic', 'lineinfo'],
  \        [ 'percent' ],
  \        [ 'fileformat', 'fileencoding', 'filetype' ]
  \      ],
  \     'left':  [ [ 'mode'], ['fugitive'] ]
  \   },
  \   'component_function': {
  \     'modified': 'LightLineModified',
  \     'readonly': 'LightLineReadonly',
  \     'fugitive': 'LightLineFugitive',
  \     'filename': 'LightLineFilename',
  \     'fileformat': 'LightLineFileformat',
  \     'filetype': 'LightLineFiletype',
  \     'mode': 'LightLineMode',
  \   },
  \   'component_expand': {
  \     'syntastic': 'SyntasticStatuslineFlag'
  \   },
  \   'component_type': {
  \     'syntastic': 'error'
  \   }
  \ }

function! LightLineModified()
  return &ft =~ 'help\|vimfiler\|gundo' ? '' : &modified ? '+' : &modifiable ? '' : '-'
endfunction

function! LightLineReadonly()
  return &ft !~? 'help\|vimfiler\|gundo' && &readonly ? 'ğŸ”’ ' : ''
endfunction

function! LightLineFilename()
  return ('' != LightLineReadonly() ? LightLineReadonly() . ' ' : '') .
        \ (&ft == 'vimfiler' ? vimfiler#get_status_string() :
        \  &ft == 'unite' ? unite#get_status_string() :
        \  &ft == 'vimshell' ? vimshell#get_status_string() :
        \ '' != expand('%:t') ? expand('%:t') : '[No Name]') .
        \ ('' != LightLineModified() ? ' ' . LightLineModified() : '')
endfunction

function! LightLineFugitive()
  try
    if &ft !~? 'vimfiler\|gundo' && exists('*fugitive#head')
      return fugitive#head()
    endif
  catch
  endtry
  return ''
endfunction

function! LightLineFileformat()
  return winwidth(0) > 70 ? &fileformat : ''
endfunction

function! LightLineFiletype()
  return winwidth(0) > 70 ? (strlen(&filetype) ? &filetype : 'no ft') : ''
endfunction

function! LightLineFileencoding()
  return winwidth(0) > 70 ? (strlen(&fenc) ? &fenc : &enc) : ''
endfunction

function! LightLineMode()
  return winwidth(0) > 60 ? lightline#mode() : ''
endfunction

" ==================================================
" syntastic
" ==================================================
"  mode ã« active ã‚’æŒ‡å®šã™ã‚‹ã¨ä¿å­˜ã™ã‚‹ãŸã³ã«ã€
"          passiveã‚’æŒ‡å®šã™ã‚‹ã¨ :SyntasticCheck ã‚’å®Ÿè¡Œæ™‚ã«æ¤œå‡ºã•ã‚Œã¾ã™
let g:syntastic_ruby_checkers = [ 'rubocop' ]
let g:syntastic_javascript_checkers = [ 'jshint' ]
let g:syntastic_scss_checkers = ['scss_lint']

let g:syntastic_enable_perl_checker = 1
let g:syntastic_perl_checkers = ['perl', 'podchecker']

augroup AutoSyntastic
  autocmd!
  autocmd BufWritePost * call s:syntastic()
augroup END

function! s:syntastic()
  SyntasticCheck
  call lightline#update()
endfunction

" ==================================================
" Emmet
" ==================================================
let g:user_emmet_expandabbr_key='<c-y>'

" ==================================================
" vim-json
" ==================================================
let g:vim_json_syntax_conceal = 0

" ==================================================
" clever-f.vim
" ==================================================
" å¤§æ–‡å­—ã‚’å…¥åŠ›ã—ãŸæ™‚ã ã‘å¤§æ–‡å­—å°æ–‡å­—ã‚’åŒºåˆ¥ã™ã‚‹ã‚ˆã†ã«
let g:clever_f_smart_case = 1
" ç¾åœ¨è¡Œã®ã¿ã‚’æ¤œç´¢å¯¾è±¡ã«
let g:clever_f_across_no_line = 1
" fã¨Fã®ç§»å‹•æ–¹å‘ã‚’å›ºå®šã™ã‚‹
let g:clever_f_fix_key_direction = 1

" ==================================================
" vim-expand-region
" ==================================================
vmap v <Plug>(expand_region_expand)
vmap <C-v> <Plug>(expand_region_shrink)

